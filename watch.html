<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<script src="js/mui.min.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
	</head>
	<style type="text/css">
		html, body{
			padding: 0;
			margin: 0;
			/*background: #00ff00;*/
		}
	</style>
	<body>
		<div class="pulltorefresh" id="articles">
			<div id="refreshContainer" class="mui-content mui-scroll-wrapper">
			  <div class="mui-scroll">
			    <ul class="mui-table-view mui-table-view-chevron" >
			      <li class="mui-table-view-cell mui-media" v-for="(item, index) in articleList" @click='goToDetail(item.id)'>
			        <a href="javascript:;">
			          <img class="mui-media-object mui-pull-left" :src="item.logo">
			          <div class="mui-media-body">
			            <span class="title">{{item.title}}</span>
			          </div>
			        </a>
			        <!--aa-->
				    </li>
				    <!--<li style="text-align: center;height: 30px;line-height: 30px;" @click="getMoreData()">加载更多</li>-->
			    </ul>
			  </div>
			</div>
		</div>	
		<!--下拉刷新容器-->
	</body>
	<script type="text/javascript">
		var vm = new Vue({
		  el: '#articles',
		  data: {
		    message: 'Hello Vue!',
		    articleList: [],
		    page: 1
		  },
		  methods: {
			  goToDetail: function(itemId) {
			  	mui.openWindow({
				    url:'videoDetail.html',
				    id:'videoDetail.html',
				    extras:{
			        videoId:parseInt(itemId)
				    }
					})
			  }
			}
		})
		mui.init({
			pullRefresh : {
		    container:"#refreshContainer",//下拉刷新容器标识，querySelector能定位的css选择器均可，比如：id、.class等
		    down : {
//		    	contentdown : "下拉刷新",//可选，在下拉可刷新状态时，下拉刷新控件上显示的标题内容
//					contentover : "释放立即刷新",//可选，在释放可刷新状态时，下拉刷新控件上显示的标题内容
//					contentrefresh : "正在刷新...",//可选，正在刷新状态时，下拉刷新控件上显示的标题内容
		      style:'circle',//必选，下拉刷新样式，目前支持原生5+ ‘circle’ 样式
		      color:'#2BD009', //可选，默认“#2BD009” 下拉刷新控件颜色
		      height:'50px',//可选,默认50px.下拉刷新控件的高度,
		      range:'100px', //可选 默认100px,控件可下拉拖拽的范围
		      offset:'0px', //可选 默认0px,下拉刷新控件的起始位置
		      auto: true,//可选,默认false.首次加载自动上拉刷新一次
		      callback :pulltofresh //-function //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
		    },
		    up : {
		    	contentdown : "正在加载",
		    	callback :pushtoloadmore
		    }
		  }
		});
		function pulltofresh() {
			vm.page = 1;
			mui.ajax('https://api.walian.cn/api/article-lists', {
				data: {
					channelId: 32,
					rows: 10,
					page: vm.page
				},
				dataType:'json',//服务器返回json格式数据
	      type:'post',//HTTP请求类型
	      timeout:10000,//超时时间设置为10秒；
	      success: function(res) {
	      	vm.articleList = res.data.list;
	      	vm.page++;
	      },
	      error: function(e) {
	      	console.log(e);
	      }
			})
			mui('#refreshContainer').pullRefresh().endPulldownToRefresh();
		}
		function pushtoloadmore(){
			vm.page++;
			mui.ajax('https://api.walian.cn/api/article-lists', {
				data: {
					channelId: 32,
					rows: 10,
					page: vm.page
				},
				dataType:'json',//服务器返回json格式数据
	      type:'post',//HTTP请求类型
	      timeout:10000,//超时时间设置为10秒；
	      success: function(res) {
	      	vm.articleList = vm.articleList.concat(res.data.list);
	      },
	      error: function(e) {
	      	console.log(e);
	      }
			})
			mui('#refreshContainer').pullRefresh().endPullupToRefresh();
		}
	</script>
	<style type="text/css">
		.mui-table-view-cell{
			padding-right: 10px !important;
		}
		.mui-table-view-cell a{
			height: 100px;
		}
		.mui-table-view-chevron .mui-table-view-cell>a:not(.mui-btn) {
			margin-right: 0;
		}
		.mui-table-view-cell img{
			width: 125px;
			max-width: 125px !important;
			line-height: 100px !important;
			height: 76px !important;
		}
		.mui-table-view-cell .mui-media-body {
			height: 76px;
			/*line-height: 25px;*/
		}
		.mui-table-view-cell .mui-media-body .title{
			height: 50px;
			max-height: 50px;
			line-height: 25px;
			overflow: hidden;
			text-overflow: ellipsis;
			white-space: normal;
		}
		.pulltorefresh {
			position: relative;
			width: 100%;
			height: 100vh;
		}
	</style>
</html>